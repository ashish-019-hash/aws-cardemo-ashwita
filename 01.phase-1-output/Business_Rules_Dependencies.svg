<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .rule-box { fill: #e8f4fd; stroke: #1f77b4; stroke-width: 2; }
      .process-box { fill: #fff2cc; stroke: #d6b656; stroke-width: 2; }
      .dependency-arrow { stroke: #2ca02c; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .shared-arrow { stroke: #ff7f0e; stroke-width: 3; fill: none; marker-end: url(#arrowhead-shared); }
      .rule-text { font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; }
      .process-text { font-family: Arial, sans-serif; font-size: 11px; }
      .title-text { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; }
      .legend-text { font-family: Arial, sans-serif; font-size: 10px; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2ca02c" />
    </marker>
    <marker id="arrowhead-shared" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ff7f0e" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" class="title-text">CardDemo COBOL Business Rules Dependencies</text>
  
  <!-- Core Transaction ID Generation Rule -->
  <rect x="320" y="60" width="160" height="80" rx="5" class="rule-box"/>
  <text x="400" y="85" text-anchor="middle" class="rule-text">RULE-CALC-002</text>
  <text x="400" y="100" text-anchor="middle" class="process-text">Transaction ID</text>
  <text x="400" y="115" text-anchor="middle" class="process-text">Generation</text>
  <text x="400" y="130" text-anchor="middle" class="process-text">(COBIL00C, COTRN02C)</text>
  
  <!-- Bill Payment Balance Calculation -->
  <rect x="80" y="200" width="160" height="80" rx="5" class="rule-box"/>
  <text x="160" y="225" text-anchor="middle" class="rule-text">RULE-CALC-001</text>
  <text x="160" y="240" text-anchor="middle" class="process-text">Bill Payment</text>
  <text x="160" y="255" text-anchor="middle" class="process-text">Balance Calculation</text>
  <text x="160" y="270" text-anchor="middle" class="process-text">(COBIL00C:234)</text>
  
  <!-- Transaction Addition Process -->
  <rect x="560" y="200" width="160" height="80" rx="5" class="process-box"/>
  <text x="640" y="225" text-anchor="middle" class="rule-text">Transaction Addition</text>
  <text x="640" y="240" text-anchor="middle" class="process-text">Process</text>
  <text x="640" y="255" text-anchor="middle" class="process-text">(COTRN02C)</text>
  <text x="640" y="270" text-anchor="middle" class="process-text">Uses RULE-CALC-002</text>
  
  <!-- Daily Report Date Calculation -->
  <rect x="200" y="360" width="160" height="80" rx="5" class="rule-box"/>
  <text x="280" y="385" text-anchor="middle" class="rule-text">RULE-CALC-003</text>
  <text x="280" y="400" text-anchor="middle" class="process-text">Daily Report</text>
  <text x="280" y="415" text-anchor="middle" class="process-text">Date Calculation</text>
  <text x="280" y="430" text-anchor="middle" class="process-text">(CORPT00C:229-230)</text>
  
  <!-- Monthly Report Date Calculation -->
  <rect x="440" y="360" width="160" height="80" rx="5" class="rule-box"/>
  <text x="520" y="385" text-anchor="middle" class="rule-text">RULE-CALC-004</text>
  <text x="520" y="400" text-anchor="middle" class="process-text">Monthly Report</text>
  <text x="520" y="415" text-anchor="middle" class="process-text">Date Calculation</text>
  <text x="520" y="430" text-anchor="middle" class="process-text">(CORPT00C:224-228)</text>
  
  <!-- Report Generation Process -->
  <rect x="320" y="500" width="160" height="60" rx="5" class="process-box"/>
  <text x="400" y="525" text-anchor="middle" class="rule-text">Report Generation</text>
  <text x="400" y="540" text-anchor="middle" class="process-text">Framework</text>
  <text x="400" y="555" text-anchor="middle" class="process-text">(CORPT00C)</text>
  
  <!-- Dependency Arrows -->
  <!-- Transaction ID to Bill Payment -->
  <path d="M 360 140 Q 300 170 200 200" class="shared-arrow"/>
  
  <!-- Transaction ID to Transaction Addition -->
  <path d="M 440 140 Q 500 170 600 200" class="shared-arrow"/>
  
  <!-- Daily Report to Report Generation -->
  <path d="M 320 440 Q 350 470 360 500" class="dependency-arrow"/>
  
  <!-- Monthly Report to Report Generation -->
  <path d="M 480 440 Q 450 470 440 500" class="dependency-arrow"/>
  
  <!-- Legend -->
  <rect x="20" y="480" width="200" height="100" rx="5" fill="none" stroke="#666" stroke-width="1"/>
  <text x="30" y="500" class="legend-text" font-weight="bold">Legend:</text>
  
  <rect x="30" y="510" width="15" height="10" class="rule-box"/>
  <text x="50" y="520" class="legend-text">Business Calculation Rule</text>
  
  <rect x="30" y="530" width="15" height="10" class="process-box"/>
  <text x="50" y="540" class="legend-text">Business Process</text>
  
  <line x1="30" y1="550" x2="45" y2="550" class="shared-arrow"/>
  <text x="50" y="555" class="legend-text">Shared Dependency</text>
  
  <line x1="30" y1="565" x2="45" y2="565" class="dependency-arrow"/>
  <text x="50" y="570" class="legend-text">Process Dependency</text>
  
  <!-- Key Insights Box -->
  <rect x="550" y="480" width="230" height="100" rx="5" fill="#f0f8ff" stroke="#4682b4" stroke-width="1"/>
  <text x="560" y="500" class="legend-text" font-weight="bold">Key Insights:</text>
  <text x="560" y="515" class="legend-text">• RULE-CALC-002 is shared across</text>
  <text x="560" y="527" class="legend-text">  multiple business processes</text>
  <text x="560" y="542" class="legend-text">• Critical for transaction integrity</text>
  <text x="560" y="557" class="legend-text">• Report rules support different</text>
  <text x="560" y="569" class="legend-text">  time periods (daily/monthly)</text>
</svg>
