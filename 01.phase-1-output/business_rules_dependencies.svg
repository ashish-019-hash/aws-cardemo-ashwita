<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; fill: #34495e; }
      .rule-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; rx: 8; }
      .rule-text { font-family: Arial, sans-serif; font-size: 12px; fill: white; font-weight: bold; }
      .data-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; rx: 5; }
      .data-text { font-family: Arial, sans-serif; font-size: 11px; fill: white; }
      .process-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; rx: 5; }
      .process-text { font-family: Arial, sans-serif; font-size: 11px; fill: white; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .formula-box { fill: #f39c12; stroke: #e67e22; stroke-width: 2; rx: 5; }
      .formula-text { font-family: 'Courier New', monospace; font-size: 10px; fill: white; }
      .legend-text { font-family: Arial, sans-serif; font-size: 10px; fill: #2c3e50; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" class="title">CardDemo COBOL Business Rules Dependencies</text>
  <text x="400" y="50" text-anchor="middle" class="subtitle">Bill Payment Processing Flow</text>
  
  <!-- Input Data -->
  <rect x="50" y="100" width="150" height="60" class="data-box"/>
  <text x="125" y="120" text-anchor="middle" class="data-text">Account Master</text>
  <text x="125" y="135" text-anchor="middle" class="data-text">ACCT-CURR-BAL</text>
  <text x="125" y="150" text-anchor="middle" class="data-text">(Current Balance)</text>
  
  <rect x="250" y="100" width="150" height="60" class="data-box"/>
  <text x="325" y="120" text-anchor="middle" class="data-text">Transaction Input</text>
  <text x="325" y="135" text-anchor="middle" class="data-text">TRAN-AMT</text>
  <text x="325" y="150" text-anchor="middle" class="data-text">(Payment Amount)</text>
  
  <!-- Business Rule -->
  <rect x="200" y="220" width="250" height="80" class="rule-box"/>
  <text x="325" y="240" text-anchor="middle" class="rule-text">RULE-CALC-001</text>
  <text x="325" y="255" text-anchor="middle" class="rule-text">Bill Payment Balance Calculation</text>
  <text x="325" y="270" text-anchor="middle" class="rule-text">Location: COBIL00C.cbl:234</text>
  <text x="325" y="285" text-anchor="middle" class="rule-text">Section: PROCESS-ENTER-KEY</text>
  
  <!-- Calculation Formula -->
  <rect x="150" y="340" width="350" height="40" class="formula-box"/>
  <text x="325" y="355" text-anchor="middle" class="formula-text">COMPUTE ACCT-CURR-BAL = ACCT-CURR-BAL - TRAN-AMT</text>
  <text x="325" y="370" text-anchor="middle" class="formula-text">New Balance = Current Balance - Payment Amount</text>
  
  <!-- Output -->
  <rect x="200" y="420" width="250" height="60" class="process-box"/>
  <text x="325" y="440" text-anchor="middle" class="process-text">Updated Account Balance</text>
  <text x="325" y="455" text-anchor="middle" class="process-text">Written to Account Master</text>
  <text x="325" y="470" text-anchor="middle" class="process-text">Transaction Record Created</text>
  
  <!-- Arrows -->
  <line x1="125" y1="160" x2="250" y2="220" class="arrow"/>
  <line x1="325" y1="160" x2="350" y2="220" class="arrow"/>
  <line x1="325" y1="300" x2="325" y2="340" class="arrow"/>
  <line x1="325" y1="380" x2="325" y2="420" class="arrow"/>
  
  <!-- Conditions Box -->
  <rect x="500" y="200" width="250" height="120" class="data-box"/>
  <text x="625" y="220" text-anchor="middle" class="data-text">Input Conditions:</text>
  <text x="625" y="235" text-anchor="middle" class="data-text">• Account ID valid</text>
  <text x="625" y="250" text-anchor="middle" class="data-text">• Transaction amount > 0</text>
  <text x="625" y="265" text-anchor="middle" class="data-text">• User confirmation provided</text>
  <text x="625" y="280" text-anchor="middle" class="data-text">• Account found in master file</text>
  <text x="625" y="295" text-anchor="middle" class="data-text">• Sufficient balance (implied)</text>
  
  <!-- Legend -->
  <rect x="50" y="520" width="700" height="60" fill="none" stroke="#bdc3c7" stroke-width="1"/>
  <text x="60" y="540" class="legend-text">Legend:</text>
  <rect x="110" y="530" width="15" height="10" class="data-box"/>
  <text x="130" y="539" class="legend-text">Data Elements</text>
  <rect x="220" y="530" width="15" height="10" class="rule-box"/>
  <text x="240" y="539" class="legend-text">Business Rule</text>
  <rect x="330" y="530" width="15" height="10" class="formula-box"/>
  <text x="350" y="539" class="legend-text">Calculation</text>
  <rect x="430" y="530" width="15" height="10" class="process-box"/>
  <text x="450" y="539" class="legend-text">Output/Process</text>
  
  <text x="60" y="560" class="legend-text">Note: This diagram shows the single business calculation rule identified in the CardDemo COBOL application.</text>
  <text x="60" y="575" class="legend-text">Most other programs handle user interface, data validation, and administrative functions without business calculations.</text>
</svg>
