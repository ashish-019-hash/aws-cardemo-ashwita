<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-color="#00000040"/>
    </filter>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="24" font-weight="bold" fill="#2c3e50">
    CardDemo COBOL Business Rules Dependencies
  </text>
  
  <!-- Legend -->
  <rect x="50" y="60" width="300" height="120" fill="#f8f9fa" stroke="#dee2e6" 
        stroke-width="1" rx="5" filter="url(#shadow)"/>
  <text x="60" y="80" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#495057">
    Legend:
  </text>
  <rect x="70" y="90" width="20" height="15" fill="#e3f2fd" stroke="#1976d2"/>
  <text x="100" y="102" font-family="Arial, sans-serif" font-size="12" fill="#495057">
    Financial Calculations
  </text>
  <rect x="70" y="110" width="20" height="15" fill="#f3e5f5" stroke="#7b1fa2"/>
  <text x="100" y="122" font-family="Arial, sans-serif" font-size="12" fill="#495057">
    Date/Time Calculations
  </text>
  <rect x="70" y="130" width="20" height="15" fill="#e8f5e8" stroke="#388e3c"/>
  <text x="100" y="142" font-family="Arial, sans-serif" font-size="12" fill="#495057">
    Pagination/Navigation
  </text>
  <rect x="70" y="150" width="20" height="15" fill="#fff3e0" stroke="#f57c00"/>
  <text x="100" y="162" font-family="Arial, sans-serif" font-size="12" fill="#495057">
    Utility Functions
  </text>
  
  <!-- Financial Calculations Group -->
  <g id="financial-group">
    <!-- RULE-CALC-003: Amount Format Conversion -->
    <rect x="100" y="220" width="200" height="80" fill="#e3f2fd" stroke="#1976d2" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="200" y="240" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#1976d2">
      RULE-CALC-003
    </text>
    <text x="200" y="255" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Transaction Amount
    </text>
    <text x="200" y="270" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Format Conversion
    </text>
    <text x="200" y="285" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      COTRN02C.cbl:383-386
    </text>
    
    <!-- RULE-CALC-002: Transaction ID Generation -->
    <rect x="400" y="220" width="200" height="80" fill="#e3f2fd" stroke="#1976d2" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="500" y="240" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#1976d2">
      RULE-CALC-002
    </text>
    <text x="500" y="255" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Transaction ID
    </text>
    <text x="500" y="270" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Generation
    </text>
    <text x="500" y="285" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      COTRN02C.cbl:448-449
    </text>
    
    <!-- RULE-CALC-001: Bill Payment Balance Calculation -->
    <rect x="700" y="220" width="200" height="80" fill="#e3f2fd" stroke="#1976d2" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="800" y="240" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#1976d2">
      RULE-CALC-001
    </text>
    <text x="800" y="255" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Bill Payment
    </text>
    <text x="800" y="270" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Balance Calculation
    </text>
    <text x="800" y="285" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      COBIL00C.cbl:234
    </text>
  </g>
  
  <!-- Date/Time Calculations Group -->
  <g id="datetime-group">
    <!-- RULE-CALC-008: Date Validation -->
    <rect x="100" y="380" width="200" height="80" fill="#fff3e0" stroke="#f57c00" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="200" y="400" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#f57c00">
      RULE-CALC-008
    </text>
    <text x="200" y="415" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Date Validation
    </text>
    <text x="200" y="430" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      and Conversion
    </text>
    <text x="200" y="445" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      CSUTLDTC.cbl:116-124
    </text>
    
    <!-- RULE-CALC-004: Monthly Report Date Range -->
    <rect x="400" y="380" width="200" height="80" fill="#f3e5f5" stroke="#7b1fa2" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="500" y="400" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#7b1fa2">
      RULE-CALC-004
    </text>
    <text x="500" y="415" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Monthly Report
    </text>
    <text x="500" y="430" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Date Range
    </text>
    <text x="500" y="445" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      CORPT00C.cbl:217-236
    </text>
    
    <!-- RULE-CALC-005: Yearly Report Date Range -->
    <rect x="700" y="380" width="200" height="80" fill="#f3e5f5" stroke="#7b1fa2" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="800" y="400" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#7b1fa2">
      RULE-CALC-005
    </text>
    <text x="800" y="415" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Yearly Report
    </text>
    <text x="800" y="430" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Date Range
    </text>
    <text x="800" y="445" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      CORPT00C.cbl:243-253
    </text>
  </g>
  
  <!-- Pagination/Navigation Group -->
  <g id="pagination-group">
    <!-- RULE-CALC-006: Page Number Calculation -->
    <rect x="250" y="540" width="200" height="80" fill="#e8f5e8" stroke="#388e3c" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="350" y="560" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#388e3c">
      RULE-CALC-006
    </text>
    <text x="350" y="575" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Transaction Page
    </text>
    <text x="350" y="590" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Number Calculation
    </text>
    <text x="350" y="605" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      COTRN00C.cbl:306-308
    </text>
    
    <!-- RULE-CALC-007: Screen Record Counter -->
    <rect x="550" y="540" width="200" height="80" fill="#e8f5e8" stroke="#388e3c" 
          stroke-width="2" rx="8" filter="url(#shadow)"/>
    <text x="650" y="560" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#388e3c">
      RULE-CALC-007
    </text>
    <text x="650" y="575" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Card Listing Screen
    </text>
    <text x="650" y="590" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">
      Record Counter
    </text>
    <text x="650" y="605" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#666">
      COCRDLIC.cbl:1163
    </text>
  </g>
  
  <!-- Dependency Arrows -->
  <!-- Amount Format Conversion → Bill Payment Balance Calculation -->
  <line x1="300" y1="260" x2="700" y2="260" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="500" y="250" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#666">
    Amount feeds into payment
  </text>
  
  <!-- Transaction ID Generation → Bill Payment Balance Calculation -->
  <line x1="600" y1="260" x2="700" y2="260" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="650" y="250" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#666">
    ID required for transaction
  </text>
  
  <!-- Date Validation → Monthly Report Date Range -->
  <line x1="300" y1="420" x2="400" y2="420" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="350" y="410" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#666">
    Validates dates
  </text>
  
  <!-- Date Validation → Yearly Report Date Range -->
  <line x1="300" y1="430" x2="700" y2="430" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="500" y="420" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#666">
    Validates dates
  </text>
  
  <!-- Similar Logic Connection (dotted line) -->
  <line x1="450" y1="580" x2="550" y2="580" stroke="#666" stroke-width="2" 
        stroke-dasharray="5,5"/>
  <text x="500" y="570" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#666">
    Similar pagination logic
  </text>
  
  <!-- Data Flow Indicators -->
  <text x="600" y="700" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#495057">
    Primary Data Flow: Amount Conversion → Transaction ID → Bill Payment Processing
  </text>
  
  <!-- Summary Box -->
  <rect x="950" y="200" width="220" height="400" fill="#f8f9fa" stroke="#dee2e6" 
        stroke-width="1" rx="5" filter="url(#shadow)"/>
  <text x="1060" y="220" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#495057">
    Rule Summary
  </text>
  
  <text x="960" y="250" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1976d2">
    Financial (3 rules):
  </text>
  <text x="960" y="270" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Amount format conversion
  </text>
  <text x="960" y="285" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Transaction ID generation
  </text>
  <text x="960" y="300" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Bill payment calculation
  </text>
  
  <text x="960" y="330" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7b1fa2">
    Date/Time (2 rules):
  </text>
  <text x="960" y="350" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Monthly report dates
  </text>
  <text x="960" y="365" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Yearly report dates
  </text>
  
  <text x="960" y="395" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#388e3c">
    Pagination (2 rules):
  </text>
  <text x="960" y="415" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Transaction page numbers
  </text>
  <text x="960" y="430" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Card listing counters
  </text>
  
  <text x="960" y="460" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#f57c00">
    Utility (1 rule):
  </text>
  <text x="960" y="480" font-family="Arial, sans-serif" font-size="11" fill="#333">
    • Date validation/conversion
  </text>
  
  <text x="960" y="520" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#495057">
    Key Dependencies:
  </text>
  <text x="960" y="540" font-family="Arial, sans-serif" font-size="10" fill="#333">
    • Amount conversion enables
  </text>
  <text x="960" y="552" font-family="Arial, sans-serif" font-size="10" fill="#333">
      payment processing
  </text>
  <text x="960" y="570" font-family="Arial, sans-serif" font-size="10" fill="#333">
    • Transaction ID required
  </text>
  <text x="960" y="582" font-family="Arial, sans-serif" font-size="10" fill="#333">
      for all transactions
  </text>
</svg>
